<!DOCTYPE html>
<html>
<head>
  <link rel="stylesheet" type="text/css" href="assets/styles/style.css" />
</head>
<script src = "/socket.io/socket.io.js"></script>
<script src="assets/js/jquery.js"></script>
<script>
  let socket = io.connect("http://localhost:8000");
  let socketId;
  socket.on("connect", () => {
    socketId = socket.id;
    setInterval(() => {
      socket.emit("keepalive", "idle");
    }, 1000);
  });

  socket.on("disconnect", () => {
    console.log("Disconnecting... " + socketId);
    socketId = undefined;
  });

  socket.on("alert", (data) => {
    let popUpMessage;
    if (data === "idle") {
      popUpMessage = "You seem to be inactive.. Are you encountering any problems with the app?";
    } else if (data === "press") {
      popUpMessage = "Having fun pressing the button? :)";
    } else {
      popUpMessage = "";
    }

    $(".popup").removeClass("hidden")
      .appendTo("popup-container")
      .removeClass("hidden")
      .addClass("show")
      .children().text(popUpMessage);
  });

  $(document).ready(() => {
    $(".btn-action").on("click", () => {
      console.log("BUTTON IS PRESSED!");
      socket.emit("event", "press");
    });

    $(".popup-close").on("click", () => {
      console.log("CLOSING!");
      $(".popup").removeClass("show");
      $(".popup").addClass("hidden");
    });
  });
</script>
<body>
  <div class="header">
    <div class="header-title">Web Application Notifier</div>
    <div class="header-desc">All this application do is monitor your behavior</div>
    <div class="header-div"></div>
  </div>
  <div class="body">
    <button class="btn-action">CLICK ME!</button>
  </div>
  <div class="popup-container"></div>
  <div class="popup hidden">
    <div class="popup-close"></div>
    <div class="popup-message">Hello world!</div>
  </div>
</body>
</html>
